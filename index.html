<!--HTMLのバージョンなどを指定-->
<!DOCTYPE html>
<!--この中身からがHTMLの内容ですの意-->
<html>
<!--<head>(付加情報)-->

<!--------------------------------------------------------------->
<!-- ヘッダ -->
<!--------------------------------------------------------------->

<head>
    <!--文字コード指定-->
    <meta charset="utf-8">
    <!--タブに表示するタイトル-->
    <title>web-versa-writer</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">

    <!--cssファイル読み込み-->
    <link href="css/normalize.css" rel="stylesheet" type="text/css">
    <link href="css/style.css" rel="stylesheet" type="text/css">

</head>

<!--------------------------------------------------------------->
<!-- ボディ -->
<!--------------------------------------------------------------->

<body>
    <header id="global_header">
        <nav id="global_navigation_bar">
            <div id="main_title">web-versa-writer</div>
            <div id="string_menu">
                <div id="now_text">text:</div>
                <div id="test_view">Hello</div>
                <input type="text" id="text_strings" onchange="setText()" maxlength=5 placeholder="text input (max:5)">
            </div>
            <!--カラービッカー-->
            <input type="color" id="text_color" onchange="setColor()" value="#FFFFFF">


        </nav>
    </header>
    <!--<div id="x_view"> x: <span id="x"></span>    </div>-->



    <!--フルスクリーンボタン-->
    <button id="setFullScreenButton">Full screen</button>
    <button id="setUnFullScreenButton" style="display: none;">Exit full screen</button>

    <!--表示部-->
    <div id="display" class="LtoR">Hello</div>

    <!--消し幕-->
    <div id="left_blackout"></div>
    <div id="right_blackout"></div>

    <footer id="footer">
        <a href="about" id="footer_text">このサイトについて -about- </div>
            <a href="about" id="footer_text">使い方 -How to use- </div>
    </footer>
    <!---->
    <script language="javascript" type="text/javascript">
        //変数
        var lastLPF = 0, nowLPF = 0, lastJ = 0;

        ////////////////////////////////////////////////////////////
        // バーサライタのコード
        function setText() {
            var input_message = document.getElementById("text_strings").value;
            document.getElementById("test_view").innerHTML = input_message;
            document.getElementById("display").innerHTML = input_message;
        }

        function setColor() {
            var input_message = document.getElementById("text_color").value;
            document.getElementById("display").style.color = input_message;
        }
        ////////////////////////////////////////////////////////////
        // 加速度センサ
        var element_x = document.getElementById("x");
        window.addEventListener("devicemotion", function (e) {
            var vec3d = e.acceleration;
            if (0 < lastJ && (lastLPF < -2 || 2 < lastLPF)) {
                element_x.style.color = '#f00';
                const element = document.getElementById('display');
                element.classList.add("RtoL");
                element.classList.remove("LtoR");
            }
            if (lastJ < 0 && (lastLPF < -2 || 2 < lastLPF)) {
                element_x.style.color = '#0f0';
                const element = document.getElementById('display');
                element.classList.add("LtoR");
                element.classList.remove("RtoL");
            }
            nowLPF = LPF(vec3d.x);
            lastJ = dx(nowLPF, lastLPF);
            lastLPF = nowLPF;
            element_x.textContent = String(lastJ);
        });
        ///////
        // LPF
        function LPF(raw) {
            var LPF = 0, k = 0.1;
            LPF = (1 - k) * lastLPF + k * raw;
            return LPF;
        }
        //微分
        function dx(x1, x2) {
            return (x1 - x2);
        }


        //lastLPF：前回のLPF値
        //raw ：今回の計測値
        ////////////////////////////////////////////////////////////
        // フルスクリーンのコード
        window.addEventListener('load', function () {
            // フルスクリーン表示
            document.getElementById('setFullScreenButton').addEventListener('click', function () {
                document.body.requestFullscreen();
                document.getElementById("global_header").style.display = "none";
                document.getElementById("footer").style.display = "none";
                document.getElementById("setFullScreenButton").style.display = "none";
                document.getElementById("setUnFullScreenButton").style.display = "inline";
            });
            // フルスクリーン解除
            document.getElementById('setUnFullScreenButton').addEventListener('click', function () {
                document.exitFullscreen();
                document.getElementById("global_header").style.display = "flex";
                document.getElementById("footer").style.display = "inline-block";
                document.getElementById("setFullScreenButton").style.display = "inline";
                document.getElementById("setUnFullScreenButton").style.display = "none";
            });
        });


    </script>
</body>

</html>